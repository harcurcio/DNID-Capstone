<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pitt COVID Dashboard</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <link rel="stylesheet" href="css/style.css">
    </head>

    <body onload ="goPython()">
        <header>
            <div class="navbar">
                <div class="container d-flex justify-content-between">
                    <div class="logo">
                        <a href="index.html"><h1>my<span class="title">PittDashboard</span></h1></a>
                    </div>
                    <!--menu icon-->
                    <div class="float-right openbtn" onclick="openNav()">
                        <div class="bar1"></div>
                        <div class="bar2"></div>
                        <div class="bar3"></div>
                    </div>
                </div>
            </div>
            <div id="mySidebar" class="sidebar shadow">
                <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
                <h2>Want more information?</h2>
                <p>Looking for more than what our dashboard provides? Head over to our FAQ page <a href="faq.html">here.</a></p>
                <h2>Have any questions?</h2>
                <p>Send us an email at pittcoviddashboard@gmail.com.</p>
            </div>
        </header>

        <!--alert bar-->
        <div class="alert alert-warning pitt-website" role="alert">
            If you would like to visit the Pitt COVID-19 website, click <a href=https://www.coronavirus.pitt.edu/healthy-community/campus-cases class="alert-link">here</a>. 
        </div>

        <!--widget containers & cards-->
        <div class="widget py-4">
            <div class="container">
                <div class="row">
                    <!--empty div for spacing-->
                    <div class="col-md-1">
                    </div>
                    <!--widget 1-->
                    <div class="col-md-5">
                        <div class="card mb-5 shadow-sm">
                            <div class="card-header">
                                Pitt Risk Posture  
                            </div>
                            <div class="card-body posture">
                                <p id="pos">
                                    
                                </p>
                            </div>
                        </div>
                    </div>
                    <!--widget 2-->
                    <div class="col-md-5">
                        <div class="card mb-5 shadow-sm">
                            <div class="card-header">
                                Study Spaces and Capacities 
                            </div>
                            <div class="card-body study">
                                <p id="stu">
                                    
                                </p>
                            </div>
                        </div>
                    </div>
                    <!--empty div for spacing-->
                    <div class="col-md-1">
                    </div>
                    <!--empty div for spacing-->
                    <div class="col-md-1">
                    </div>
                    <!--widget 3-->
                    <div class="col-md-5">
                        <div class="card mb-5 shadow-sm">
                            <div class="card-header">
                                Cases in Allegheny County   
                            </div>
                            <div class="card-body scroll">
                                <p class="card-text tableauPlaceholder" id='viz1607117501885' style='position: relative'><noscript><a href='#'>
                                    <img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;CO&#47;COVID-19AlleghenyCounty3_5TableauPublic&#47;COVID-19&#47;1_rss.png' style='border: none' />
                                    </a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> 
                                    <param name='embed_code_version' value='3' />
                                    <param name='site_root' value='' />
                                    <param name='name' value='COVID-19AlleghenyCounty3_5TableauPublic&#47;COVID-19' />
                                    <param name='tabs' value='no' /><param name='toolbar' value='yes' />
                                    <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;CO&#47;COVID-19AlleghenyCounty3_5TableauPublic&#47;COVID-19&#47;1.png' />
                                    <param name='animate_transition' value='yes' />
                                    <param name='display_static_image' value='yes' />
                                    <param name='display_spinner' value='yes' />
                                    <param name='display_overlay' value='yes' />
                                    <param name='display_count' value='yes' />
                                    <param name='language' value='en' /></object>
                                    <script type='text/javascript'>
                                        var divElement = document.getElementById('viz1607117501885');                    
                                        var vizElement = divElement.getElementsByTagName('object')[0];                    
                                        if ( divElement.offsetWidth > 800 ) 
                                            { vizElement.style.width='875px';vizElement.style.height='1227px';}
                                        else if ( divElement.offsetWidth > 500 ) 
                                            { vizElement.style.width='875px';vizElement.style.height='1227px';} 
                                        else { vizElement.style.width='100%';vizElement.style.height='2877px';}                    
                                        var scriptElement = document.createElement('script');                    
                                        scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                   
                                        vizElement.parentNode.insertBefore(scriptElement, vizElement);                
                                    </script>
                                </p>
                            </div>
                        </div>
                    </div>
                    <!--widget 4-->
                    <div class="col-md-5">
                        <div class="card mb-5 shadow-sm">
                            <div class="card-header">
                                Cases by state   
                            </div>
                            <div class="card-body states">
                                <p class="card-text">
                                    <div class="bingwidget" data-type="covid19_map" data-market="en-us" data-language="en-us" data-location-id="/United States/Pennsylvania"></div>
                                    <script src="//www.bing.com/widget/bootstrap.answer.js" async=""></script>
                                </p>
                            </div>
                        </div>
                    </div>
                    <!--empty div for spacing-->
                    <div class="col-md-1">
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div class="fixed-bottom" style="background-color: #f2f2f2;">
                <p>Arun Mohan and Harlie Curcio, 2020</p>
            </div>
        </footer>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="js/main.js"></script>
        <!-- jquery function that uses AJAX to call python script for web-scraping -->
        <script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
        <script>
             function goPython() {
                $.ajax({
                    url: "scraper.py",
                    success: function(){
                    }
                 });
             }
        </script>
        <!-- js function that reads data from files created by web-scraping -->
        <script>
            var txtFile = new XMLHttpRequest();
            var allText = "file not found";
            txtFile.onreadystatechange = function () {
            if (txtFile.readyState === XMLHttpRequest.DONE && txtFile.status == 200) {
                allText = txtFile.responseText;
                allText = allText.split("\n").join("<br>");
            }

             document.getElementById('pos').innerHTML = allText;
            }
            txtFile.open("GET", 'posture.txt', true);
            txtFile.send(null);
        
            var txtFile2 = new XMLHttpRequest();
            var allText2 = "file not found";
            txtFile2.onreadystatechange = function () {
            if (txtFile2.readyState === XMLHttpRequest.DONE && txtFile2.status == 200) {
                allText2 = txtFile2.responseText;
                allText2 = allText2.split("\n").join("<br>");
            }

             document.getElementById('stu').innerHTML = allText2;
            }
            txtFile2.open("GET", 'study.txt', true);
            txtFile2.send(null);
        </script>
    </body>
</html>
